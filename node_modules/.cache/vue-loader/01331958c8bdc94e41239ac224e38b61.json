{"remainingRequest":"C:\\Users\\小没没\\Desktop\\cxl\\runboo01\\frontend-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\小没没\\Desktop\\cxl\\runboo01\\frontend-web\\src\\views\\zhscjd\\scwtysl\\scjdtj.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\小没没\\Desktop\\cxl\\runboo01\\frontend-web\\src\\views\\zhscjd\\scwtysl\\scjdtj.vue","mtime":1602474269331},{"path":"C:\\Users\\小没没\\Desktop\\cxl\\runboo01\\frontend-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\小没没\\Desktop\\cxl\\runboo01\\frontend-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\小没没\\Desktop\\cxl\\runboo01\\frontend-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\小没没\\Desktop\\cxl\\runboo01\\frontend-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Pagination from '@/components/Pagination/index'\nexport default {\n  // name: 'Latsxq',\n  components: { Pagination },\n  data() {\n    return {\n      xsItem: '',\n      xsForm: {\n        wtr: '张三',\n        wtrq: ''\n      },\n      dialogFormVisible: false,\n      jdlxOption: [],\n      rowObj: {},\n      tableKey: 0,\n      // tableData: [],\n      listQuery: {\n        currentPage: 1,\n        pageSize: 10\n      },\n      tableData: [],\n      xgaj: {\n        ajmc: ''\n      },\n      fileList: [],\n      listLoading: true,\n      total: 100,\n      ajInfo: {},\n      ajList: [],\n      fileIdList: [],\n      fileIdEditorList: [],\n      fileListSave: [],\n      uploadSucess: false,\n      rules: {\n        jdlx: [\n          { required: true, message: '请进行选择', trigger: 'change' }\n        ],\n        jyaq: [\n          { required: true, message: '请进行输入', trigger: 'change' }\n        ],\n        wtyq: [\n          { required: true, message: '请进行输入', trigger: 'change' }\n        ]\n      }\n    }\n  },\n\n  mounted() {\n    this.xsForm.wtrname = JSON.parse(window.localStorage.getItem('userInfo')).name\n    this.xsForm.wtrid = JSON.parse(window.localStorage.getItem('userInfo')).id\n    this.xsForm.wtrq = this.moment().format('YYYY-MM-DD')\n    this.xsItem = this.$route.query.xsInfoId\n    if (this.xsItem === '' || this.xsItem === undefined) { // 新增\n\n    } else { // 编辑\n      // this.xsItem = this.$route.query.xsInfoId\n      this.getXsInfo(this.xsItem)\n    }\n    this.getJdlx()\n  },\n  methods: {\n    handleExceed(files, fileList) {\n      this.$message.warning('请最多上传 ${this.limit} 个文件')\n    },\n    beforeUpload(file) {\n      const isLt2M = file.size / 1024 / 1024 < 100\n      if (!isLt2M) {\n        this.$message({\n          message: '上传文件大小不能超过 100MB!',\n          type: 'warning'\n        })\n      }\n      const formDatas = new FormData()\n      formDatas.append('file', file)\n      this.$api.upload(formDatas).then(res => {\n        this.uploadSucess = true\n        this.fileIdList.push({ id: res.data })\n        if (this.xsItem) {\n          this.xsForm.file.push(res.data)\n          this.fileIdEditorList = this.xsForm.file\n          for (let i = 0; i < this.xsForm.file.length; i++) {\n            this.fileIdEditorList[i] = { id: this.xsForm.file[i] }\n          }\n          const obj = this.fileList.map((item, index) => {\n            return { ...item, ... this.fileIdEditorList[index] }\n          })\n          // console.log(obj)\n          this.fileList = obj\n        } else {\n          this.fileListSave.push(res.data)\n          const obj = this.fileList.map((item, index) => {\n            return { ...item, ... this.fileIdList[index] }\n          })\n          // console.log(obj)\n          this.fileList = obj\n        }\n      })\n      return false\n    },\n    // 上传\n    handleChange(file) {\n      if (file.status === 'ready') {\n        const formDatas = new FormData()\n        formDatas.append('file', file)\n        const dataType = file.name\n        const types = dataType.substring(dataType.lastIndexOf('.') + 1)\n        let type = ''\n        if (types === 'jpg' || types === 'png' || types === 'jpeg' || types === 'gif' || types === 'psd') {\n          type = 'pic'\n        } else if (types === 'mp4' || types === 'avi' || types === 'wmv' || types === 'rm' || types === 'swf' || types === 'flv') {\n          type = 'video'\n        } else if (types === 'mp3' || types === 'wav' || types === 'ogg' || types === 'm4a') {\n          type = 'audio'\n        } else {\n          type = 'wx'\n        }\n        this.$set(file, 'type', type)\n        // 判断是否已经存在此文件\n        var ret2 = this.fileList.findIndex((v) => {\n          return v.name === file.name\n        })\n        if (ret2 !== -1) {\n          this.$message.error('文件已上传')\n          return\n        }\n        if (this.fileList.length > 2) {\n          this.$message.error('最多上传3个文件')\n          return false\n        }\n        this.fileList.push(file)\n        let sum = 0\n        this.fileList.forEach(function(item, index) {\n          if (item.size) {\n            sum = sum + item.size\n          }\n        })\n        const isLt2M = sum / 1024 / 1024 < 100\n        if (!isLt2M) {\n          this.$message({\n            message: '上传文件大小不能超过 100MB!',\n            type: 'warning'\n          })\n          return false\n        }\n        this.$refs.upload.submit()\n      }\n    },\n    handleSuccess(res) {\n\n    },\n    delWj(obj) {\n      this.fileList = this.fileList.filter(function(item) {\n        return item.name !== obj.name\n      })\n      this.$api.delFile({ id: obj.id }).then(response => {\n        if (response.code === 200) {\n          this.fileList = this.fileList.filter(item => item.id !== obj.id)\n          if (this.xsItem) {\n            this.xsForm.file = this.xsForm.file.filter(item => item !== obj.id)\n            // console.log(this.xsForm.file)\n          } else {\n            this.fileListSave = this.fileListSave.filter(item => item !== obj.id)\n            // console.log(this.fileListSave)\n          }\n          this.uploadSucess = true\n        } else {\n          this.$message({\n            message: response.message,\n            type: 'warning'\n          })\n        }\n      })\n    },\n    handleRemove(file, fileList) {\n      // 处理 before-upload验证不通过后触发了on-remove的解决办法\n      if (file && file.status === 'success') {\n        return this.$confirm('你确定删除这个文件？')\n      }\n    },\n    getXsInfo(xsbh) {\n      const params = {\n        id: xsbh\n      }\n      this.$api.getScwtById(params).then(response => {\n        if (response.code === 200) {\n          this.xsForm = response.data\n          this.xgaj.ajmc = this.xsForm.ajmc\n          this.xgaj.ajlb = this.xsForm.ajlb\n          this.xgaj.bmsah = this.xsForm.bmsah\n          this.xgaj.cbbm = this.xsForm.cbbm\n          this.xgaj.cbdw = this.xsForm.cbdw\n          this.fileList = this.xsForm.zls\n        } else {\n          this.$message.error(response.message)\n        }\n      })\n    },\n    choseAj: function() {\n      this.dialogFormVisible = true\n      this.getajList()// 相关案件\n    },\n    handleFilter() {\n      this.listQuery.currentPage = 1\n      this.getajList(this.listQuery)\n    },\n    changeCellStyle({ row, columnIndex }) {\n      if (columnIndex === 0) {\n        return 'color: #4084ef'\n      }\n    },\n    getajList() {\n      this.listLoading = true\n      this.$api.getAjxx(this.listQuery).then(response => {\n        this.ajInfo = response\n        this.ajList = response.list\n        this.total = response.total\n        // this.$refs.selectTable.setCurrentRow(this.rowObj)\n        this.listLoading = false\n      })\n    },\n    handleCurrentChange(val) {\n      this.rowObj = val\n    },\n    choseQD: function() {\n      this.xgaj = this.rowObj\n      this.dialogFormVisible = false\n    },\n    getJdlx: function() {\n      this.$api.getCode('jdlx').then(response => {\n        if (response.code === 200) {\n          this.jdlxOption = response.data\n        } else {\n          this.$message.error(response.message)\n        }\n      })\n    },\n    addTo: function() {\n      if (this.xgaj.ajmc === '') {\n        this.$message.error('请先输入案件名称')\n        return false\n      }\n      // if (this.uploadSucess === false) {\n      //   this.$message.error('文件尚未上传成功')\n      //   return false\n      // }\n      // this.xsForm.file = this.fileList\n      if (this.xsItem) {\n        // this.xsForm.file = this.fileListSave\n      } else {\n        this.xsForm.file = this.fileListSave\n      }\n      this.xsForm = Object.assign(this.xsForm, this.xgaj)\n      console.log(this.xsForm)\n      this.$refs[this.xsForm].validate((valid) => {\n        if (valid) {\n          this.$api.editScwt(this.xsForm).then(response => {\n            if (response.code === 200) {\n              this.$message({\n                message: '保存成功',\n                type: 'success'\n              })\n              this.$router.push('/wtysl')\n              this.uploadSucess = false\n            } else {\n              this.$message.error(response.message)\n            }\n          })\n        } else {\n          return false\n        }\n      })\n    },\n    refresh() {\n      this.getajList()\n    },\n    goBack: function(e) {\n      this.$router.go(-1)\n    }\n  }\n}\n",{"version":3,"sources":["scjdtj.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"scjdtj.vue","sourceRoot":"src/views/zhscjd/scwtysl","sourcesContent":["<template>\n  <div class=\"dashboard-container p0\">\n    <div class=\" clearfix\" />\n    <div class=\"p20 pt30\">\n      <el-row>\n        <span class=\"lineStep\" />\n        <span v-if=\"xsItem === '' || xsItem === undefined\">新增审查鉴定</span>\n        <span v-else>编辑审查鉴定</span>\n      </el-row>\n      <el-form :ref=\"xsForm\" :rules=\"rules\" :model=\"xsForm\" class=\"mt20\">\n        <table class=\"renderTable\">\n          <tbody>\n            <tr>\n              <td><span style=\"color: red\" class=\"mr5\">*</span>相关案件：</td>\n              <td colspan=\"3\">\n                <el-button type=\"text\" class=\"fr\" @click=\"choseAj\">选择相关案件</el-button>\n                <span>{{ xgaj.ajmc }}</span>\n              </td>\n            </tr>\n            <tr>\n              <td>部门受案号：</td>\n              <td>{{ xgaj.bmsah }}</td>\n              <td>案件类别：</td>\n              <td>\n                {{ xgaj.ajlb }}\n              </td>\n            </tr>\n            <tr>\n              <td>承办部门：</td>\n              <td>{{ xgaj.cbbm }}</td>\n              <td>承办单位：</td>\n              <td>\n                {{ xsForm.cbdw }}\n              </td>\n            </tr>\n            <tr>\n              <td>委托人：</td>\n              <td>{{ xsForm.wtr }}</td>\n              <td>委托日期：</td>\n              <td>\n                {{ xsForm.wtrq }}\n              </td>\n            </tr>\n            <tr>\n              <td><span style=\"color: red\" class=\"mr5\">*</span>鉴定类型：</td>\n              <td colspan=\"3\">\n                <el-form-item label=\"\" prop=\"jdlx\">\n                  <el-select v-model=\"xsForm.jdlx\" placeholder=\"请选择\" value-key=\"value\" style=\"width: 100%\">\n                    <el-option label=\"全部\" value=\"\" />\n                    <el-option\n                      v-for=\"item in jdlxOption\"\n                      :key=\"item.value\"\n                      :label=\"item.label\"\n                      :value=\"item.value\"\n                    />\n                  </el-select>\n                </el-form-item>\n              </td>\n            </tr>\n            <tr>\n              <td><span style=\"color: red\" class=\"mr5\">*</span>简要案情：</td>\n              <td colspan=\"3\">\n                <el-form-item label=\"\" prop=\"jyaq\">\n                  <el-input v-model=\"xsForm.jyaq\" type=\"textarea\" placeholder=\"请输入\" maxlength=\"300\" rows=\"3\" resize=\"none\" />\n                </el-form-item>\n              </td>\n            </tr>\n            <tr>\n              <td><span style=\"color: red\" class=\"mr5\">*</span>委托要求：</td>\n              <td colspan=\"3\">\n                <el-form-item label=\"\" prop=\"wtyq\">\n                  <el-input v-model=\"xsForm.wtyq\" type=\"textarea\" placeholder=\"请输入\" maxlength=\"300\" rows=\"3\" resize=\"none\" />\n                </el-form-item>\n              </td>\n            </tr>\n            <tr>\n              <td>资料上传：</td>\n              <td colspan=\"3\">\n                <ul v-if=\"fileList.length>0\" class=\"uploadShow\">\n                  <li v-for=\"(item,i) in fileList\" :key=\"i\">\n                    <span class=\"fr ml10\" style=\"cursor: pointer\" @click=\"delWj(item)\"><img src=\"@/icons/img/close.png\" height=\"12\" width=\"12\"></span>\n                    <span v-if=\"item.type=='pic'\"><img src=\"@/icons/img/pic.png\" height=\"16\" width=\"14\"></span>\n                    <span v-else-if=\"item.type=='audio'\"><img src=\"@/icons/img/audio.png\" height=\"16\" width=\"14\"></span>\n                    <span v-else-if=\"item.type=='video'\"><img src=\"@/icons/img/video.png\" height=\"16\" width=\"14\"></span>\n                    <span v-else><img src=\"@/icons/img/wd.png\" height=\"16\" width=\"14\"></span>\n                    <span>{{ item.name }}</span>\n                  </li>\n                </ul>\n                <el-upload\n                  ref=\"upload\"\n                  class=\"upload-demo fr\"\n                  action=\"string\"\n                  :auto-upload=\"false\"\n                  :on-change=\"handleChange\"\n                  :on-remove=\"handleRemove\"\n                  :show-file-list=\"false\"\n                  :on-success=\"handleSuccess\"\n                  :before-upload=\"beforeUpload\"\n                  multiple\n                  :limit=\"3\"\n                  :on-exceed=\"handleExceed\"\n                  accept=\".pdf,.doc,.docx,.jpg\"\n                >\n                  <el-button type=\"text\" class=\"fr\">上传文件</el-button>\n                </el-upload>\n              </td>\n            </tr>\n            <tr>\n              <td>备注：</td>\n              <td colspan=\"3\">\n                <el-form-item label=\"\">\n                  <el-input v-model=\"xsForm.bz\" type=\"textarea\" placeholder=\"请输入\" maxlength=\"300\" rows=\"3\" resize=\"none\" />\n                </el-form-item>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        <el-row>\n          <div class=\"mt50 fr\">\n            <el-form-item>\n              <el-button v-if=\"xsItem ==''||xsItem ==undefined\" type=\"primary\" @click=\"addTo\">确定</el-button>\n              <el-button v-if=\"xsItem\" type=\"primary\" @click=\"addTo\">保 存</el-button>\n              <el-button type=\"primary\" plain class=\"colorPlain\" @click=\"goBack\">取消</el-button>\n            </el-form-item>\n          </div>\n        </el-row>\n      </el-form>\n    </div>\n    <!--    弹出框-->\n    <el-dialog title=\"新增线索\" :visible.sync=\"dialogFormVisible\" class=\"dialog-render\" width=\"65%\">\n      <div class=\"filter-container\">\n        <el-row>\n          <el-col :span=\"7\">\n            <el-input\n              v-model=\"listQuery.ajmc\"\n              placeholder=\"请输入关键字\"\n              class=\"filter-item\"\n              clearable\n              maxlength=\"30\"\n            />\n          </el-col>\n          <el-col :span=\"4\">\n            <el-button\n              class=\"filter-item\"\n              type=\"primary\"\n              style=\"margin-left: 10px\"\n              @click=\"handleFilter\"\n            >\n              查询\n            </el-button>\n          </el-col>\n        </el-row>\n      </div>\n      <el-table\n        :key=\"tableKey\"\n        ref=\"selectTable\"\n        v-loading=\"listLoading\"\n        stripe\n        :data=\"ajList\"\n        class=\"mb50\"\n        style=\"width: 100%\"\n        :cell-style=\"changeCellStyle\"\n        highlight-current-row\n        max-height=\"300px\"\n        @row-click=\"handleCurrentChange\"\n      >\n        <el-table-column\n          prop=\"ajmc\"\n          label=\"案件名称\"\n          width=\"220\"\n          :show-overflow-tooltip=\"true\"\n        />\n        <el-table-column\n          prop=\"ajlb\"\n          label=\"案件类别\"\n          width=\"180\"\n        />\n        <el-table-column\n          prop=\"bmsah\"\n          label=\"部门受案号\"\n          width=\"190\"\n        />\n        <el-table-column\n          prop=\"slrq\"\n          label=\"受理日期\"\n          width=\"120\"\n        />\n        <el-table-column\n          prop=\"cbbmmc\"\n          label=\"承办部门\"\n          width=\"120\"\n        />\n        <el-table-column\n          prop=\"slrq\"\n          label=\"检察官\"\n          width=\"120\"\n        />\n      </el-table>\n      <div class=\"pageBox\">\n        <pagination\n          v-show=\"total > 0\"\n          :total=\"total\"\n          :page.sync=\"listQuery.currentPage\"\n          :limit.sync=\"listQuery.pageSize\"\n          @pagination=\"refresh\"\n        />\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"choseQD\">确 定</el-button>\n        <el-button type=\"primary\" plain class=\"colorPlain\" @click=\"dialogFormVisible = false\">取 消</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport Pagination from '@/components/Pagination/index'\nexport default {\n  // name: 'Latsxq',\n  components: { Pagination },\n  data() {\n    return {\n      xsItem: '',\n      xsForm: {\n        wtr: '张三',\n        wtrq: ''\n      },\n      dialogFormVisible: false,\n      jdlxOption: [],\n      rowObj: {},\n      tableKey: 0,\n      // tableData: [],\n      listQuery: {\n        currentPage: 1,\n        pageSize: 10\n      },\n      tableData: [],\n      xgaj: {\n        ajmc: ''\n      },\n      fileList: [],\n      listLoading: true,\n      total: 100,\n      ajInfo: {},\n      ajList: [],\n      fileIdList: [],\n      fileIdEditorList: [],\n      fileListSave: [],\n      uploadSucess: false,\n      rules: {\n        jdlx: [\n          { required: true, message: '请进行选择', trigger: 'change' }\n        ],\n        jyaq: [\n          { required: true, message: '请进行输入', trigger: 'change' }\n        ],\n        wtyq: [\n          { required: true, message: '请进行输入', trigger: 'change' }\n        ]\n      }\n    }\n  },\n\n  mounted() {\n    this.xsForm.wtrname = JSON.parse(window.localStorage.getItem('userInfo')).name\n    this.xsForm.wtrid = JSON.parse(window.localStorage.getItem('userInfo')).id\n    this.xsForm.wtrq = this.moment().format('YYYY-MM-DD')\n    this.xsItem = this.$route.query.xsInfoId\n    if (this.xsItem === '' || this.xsItem === undefined) { // 新增\n\n    } else { // 编辑\n      // this.xsItem = this.$route.query.xsInfoId\n      this.getXsInfo(this.xsItem)\n    }\n    this.getJdlx()\n  },\n  methods: {\n    handleExceed(files, fileList) {\n      this.$message.warning('请最多上传 ${this.limit} 个文件')\n    },\n    beforeUpload(file) {\n      const isLt2M = file.size / 1024 / 1024 < 100\n      if (!isLt2M) {\n        this.$message({\n          message: '上传文件大小不能超过 100MB!',\n          type: 'warning'\n        })\n      }\n      const formDatas = new FormData()\n      formDatas.append('file', file)\n      this.$api.upload(formDatas).then(res => {\n        this.uploadSucess = true\n        this.fileIdList.push({ id: res.data })\n        if (this.xsItem) {\n          this.xsForm.file.push(res.data)\n          this.fileIdEditorList = this.xsForm.file\n          for (let i = 0; i < this.xsForm.file.length; i++) {\n            this.fileIdEditorList[i] = { id: this.xsForm.file[i] }\n          }\n          const obj = this.fileList.map((item, index) => {\n            return { ...item, ... this.fileIdEditorList[index] }\n          })\n          // console.log(obj)\n          this.fileList = obj\n        } else {\n          this.fileListSave.push(res.data)\n          const obj = this.fileList.map((item, index) => {\n            return { ...item, ... this.fileIdList[index] }\n          })\n          // console.log(obj)\n          this.fileList = obj\n        }\n      })\n      return false\n    },\n    // 上传\n    handleChange(file) {\n      if (file.status === 'ready') {\n        const formDatas = new FormData()\n        formDatas.append('file', file)\n        const dataType = file.name\n        const types = dataType.substring(dataType.lastIndexOf('.') + 1)\n        let type = ''\n        if (types === 'jpg' || types === 'png' || types === 'jpeg' || types === 'gif' || types === 'psd') {\n          type = 'pic'\n        } else if (types === 'mp4' || types === 'avi' || types === 'wmv' || types === 'rm' || types === 'swf' || types === 'flv') {\n          type = 'video'\n        } else if (types === 'mp3' || types === 'wav' || types === 'ogg' || types === 'm4a') {\n          type = 'audio'\n        } else {\n          type = 'wx'\n        }\n        this.$set(file, 'type', type)\n        // 判断是否已经存在此文件\n        var ret2 = this.fileList.findIndex((v) => {\n          return v.name === file.name\n        })\n        if (ret2 !== -1) {\n          this.$message.error('文件已上传')\n          return\n        }\n        if (this.fileList.length > 2) {\n          this.$message.error('最多上传3个文件')\n          return false\n        }\n        this.fileList.push(file)\n        let sum = 0\n        this.fileList.forEach(function(item, index) {\n          if (item.size) {\n            sum = sum + item.size\n          }\n        })\n        const isLt2M = sum / 1024 / 1024 < 100\n        if (!isLt2M) {\n          this.$message({\n            message: '上传文件大小不能超过 100MB!',\n            type: 'warning'\n          })\n          return false\n        }\n        this.$refs.upload.submit()\n      }\n    },\n    handleSuccess(res) {\n\n    },\n    delWj(obj) {\n      this.fileList = this.fileList.filter(function(item) {\n        return item.name !== obj.name\n      })\n      this.$api.delFile({ id: obj.id }).then(response => {\n        if (response.code === 200) {\n          this.fileList = this.fileList.filter(item => item.id !== obj.id)\n          if (this.xsItem) {\n            this.xsForm.file = this.xsForm.file.filter(item => item !== obj.id)\n            // console.log(this.xsForm.file)\n          } else {\n            this.fileListSave = this.fileListSave.filter(item => item !== obj.id)\n            // console.log(this.fileListSave)\n          }\n          this.uploadSucess = true\n        } else {\n          this.$message({\n            message: response.message,\n            type: 'warning'\n          })\n        }\n      })\n    },\n    handleRemove(file, fileList) {\n      // 处理 before-upload验证不通过后触发了on-remove的解决办法\n      if (file && file.status === 'success') {\n        return this.$confirm('你确定删除这个文件？')\n      }\n    },\n    getXsInfo(xsbh) {\n      const params = {\n        id: xsbh\n      }\n      this.$api.getScwtById(params).then(response => {\n        if (response.code === 200) {\n          this.xsForm = response.data\n          this.xgaj.ajmc = this.xsForm.ajmc\n          this.xgaj.ajlb = this.xsForm.ajlb\n          this.xgaj.bmsah = this.xsForm.bmsah\n          this.xgaj.cbbm = this.xsForm.cbbm\n          this.xgaj.cbdw = this.xsForm.cbdw\n          this.fileList = this.xsForm.zls\n        } else {\n          this.$message.error(response.message)\n        }\n      })\n    },\n    choseAj: function() {\n      this.dialogFormVisible = true\n      this.getajList()// 相关案件\n    },\n    handleFilter() {\n      this.listQuery.currentPage = 1\n      this.getajList(this.listQuery)\n    },\n    changeCellStyle({ row, columnIndex }) {\n      if (columnIndex === 0) {\n        return 'color: #4084ef'\n      }\n    },\n    getajList() {\n      this.listLoading = true\n      this.$api.getAjxx(this.listQuery).then(response => {\n        this.ajInfo = response\n        this.ajList = response.list\n        this.total = response.total\n        // this.$refs.selectTable.setCurrentRow(this.rowObj)\n        this.listLoading = false\n      })\n    },\n    handleCurrentChange(val) {\n      this.rowObj = val\n    },\n    choseQD: function() {\n      this.xgaj = this.rowObj\n      this.dialogFormVisible = false\n    },\n    getJdlx: function() {\n      this.$api.getCode('jdlx').then(response => {\n        if (response.code === 200) {\n          this.jdlxOption = response.data\n        } else {\n          this.$message.error(response.message)\n        }\n      })\n    },\n    addTo: function() {\n      if (this.xgaj.ajmc === '') {\n        this.$message.error('请先输入案件名称')\n        return false\n      }\n      // if (this.uploadSucess === false) {\n      //   this.$message.error('文件尚未上传成功')\n      //   return false\n      // }\n      // this.xsForm.file = this.fileList\n      if (this.xsItem) {\n        // this.xsForm.file = this.fileListSave\n      } else {\n        this.xsForm.file = this.fileListSave\n      }\n      this.xsForm = Object.assign(this.xsForm, this.xgaj)\n      console.log(this.xsForm)\n      this.$refs[this.xsForm].validate((valid) => {\n        if (valid) {\n          this.$api.editScwt(this.xsForm).then(response => {\n            if (response.code === 200) {\n              this.$message({\n                message: '保存成功',\n                type: 'success'\n              })\n              this.$router.push('/wtysl')\n              this.uploadSucess = false\n            } else {\n              this.$message.error(response.message)\n            }\n          })\n        } else {\n          return false\n        }\n      })\n    },\n    refresh() {\n      this.getajList()\n    },\n    goBack: function(e) {\n      this.$router.go(-1)\n    }\n  }\n}\n</script>\n<style  scoped>\n   .el-dialog__body /deep/{\n    height: 500px !important;\n  }\n</style>\n<style>\n  .el-form-item__error{\n    top:0 !important;\n  }\n</style>\n\n"]}]}